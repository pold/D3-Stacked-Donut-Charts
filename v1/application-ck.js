d3.json("data.json",function(e,t){function B(e,t){var n,r;if(v[t]){n=v[t].startAngle;r=v[t].endAngle}else if(!v[t]&&v[t-1]){n=v[t-1].endAngle;r=v[t-1].endAngle}else if(!v[t-1]&&v.length>0){n=v[v.length-1].endAngle;r=v[v.length-1].endAngle}else{n=0;r=0}var t=d3.interpolate({startAngle:n,endAngle:r},{startAngle:e.startAngle,endAngle:e.endAngle});return function(e){var n=t(e);return E(n)}}function j(e){e+="";x=e.split(".");x1=x[0];x2=x.length>1?"."+x[1]:"";var t=/(\d+)(\d{3})/;while(t.test(x1))x1=x1.replace(t,"$1,$2");return x1+x2}var n=[],r=[],i=0,s=0;for(var o=0;o<t.industries.length;o++){var u={},a={},f=t.industries[o].yea_contribution,l=t.industries[o].nay_contribution;n.push({value:f.d_influence,party:"D",name:t.industries[o].name});n.push({value:f.i_influence,party:"I",name:t.industries[o].name});n.push({value:f.r_influence,party:"R",name:t.industries[o].name});r.push({value:l.d_influence,party:"D",name:t.industries[o].name});r.push({value:l.i_influence,party:"I",name:t.industries[o].name});r.push({value:l.r_influence,party:"R",name:t.industries[o].name});i+=f.total;s+=l.total}console.log(n);console.log(r);var c=800,h=600,p=40,d=Math.min(c-150,h-150)/2,v=[],m=d3.select("#graph").append("svg").attr("width",c+p).attr("height",h+p),g=m.append("line").attr("x1",0).attr("x2",c+p).attr("y1","50%").attr("y2","50%").attr("stroke","rgb(0,0,0)").attr("stroke-width",1).attr("fill","none"),y=d3.select("body").append("div").attr("class","tooltip").style("opacity",0),b=m.append("g").attr("transform","translate("+(c/2+p/2)+", "+(h/2+p/2)+")"),w=m.append("g").attr("transform","translate("+(c/2+p/2)+", "+(h/2+p/2)+")"),E=d3.svg.arc().innerRadius(d-60).outerRadius(d),S=d3.layout.pie().sort(null).value(function(e){return e.value}).startAngle(-Math.PI/2).endAngle(Math.PI/2),T=d3.layout.pie().sort(null).value(function(e){return e.value}).startAngle(Math.PI/2).endAngle(Math.PI+Math.PI/2),N=d3.scale.ordinal().range(["rgb(92,188,239)","rgb(150,163,170)","rgb(255,76,76)"]),C=b.selectAll(".arc").data(S(n)).enter().append("g").attr("class","arc");C.append("path").attr("d",E).style("fill",function(e,t){return N(t)}).style("fill-opacity",.5).style("stroke","#FFF").style("stroke-width","1px").on("mouseover",function(){var e=d3.select(this).transition().duration(250).style("fill-opacity",1);y.html("<b>"+e[0][0].__data__.data.name+"</b><br>$"+j(e[0][0].__data__.data.value)).transition().duration(250).style("opacity",1)}).on("mouseout",function(){d3.select(this).transition().duration(250).style("fill-opacity",.5);y.transition().duration(250).style("opacity",0)}).on("mousemove",function(){y.style("left",d3.event.pageX+10+"px").style("top",d3.event.pageY-75+"px")}).transition().duration(500).attrTween("d",B);var k=w.selectAll(".arc").data(T(r)).enter().append("g").attr("class","arc");k.append("path").attr("d",E).style("fill",function(e,t){return N(t)}).style("fill-opacity",.5).style("stroke","#FFF").style("stroke-width","1px").on("mouseover",function(){var e=d3.select(this).transition().duration(250).style("fill-opacity",1);y.html("<b>"+e[0][0].__data__.data.name+"</b><br>$"+j(e[0][0].__data__.data.value)).transition().duration(250).style("opacity",1)}).on("mouseout",function(){d3.select(this).transition().duration(250).style("fill-opacity",.5);y.transition().duration(250).style("opacity",0)}).on("mousemove",function(){y.style("left",d3.event.pageX+10+"px").style("top",d3.event.pageY-75+"px")}).transition().duration(500).attrTween("d",B);var L=m.append("text").text(t.info.name).attr("x",p/2).attr("y",p).attr("font-size","24px").attr("font-weight","300").attr("fill","black"),A=m.append("text").text(t.info.chamber+" - "+t.info.type).attr("x",p/2).attr("y",p+25).attr("font-size","14px").attr("font-weight","700").attr("fill","black"),O=m.append("text").text("Yeas").attr("x",p/2).attr("y","48%").attr("font-size","18px").attr("font-weight","300").attr("fill","black"),M=m.append("text").text("Nays").attr("x",p/2).attr("y","54%").attr("font-size","18px").attr("font-weight","300").attr("fill","black"),_=m.append("text").text(Math.round(parseFloat(t.info.yeas/t.info.total_votes)*100)+"% ("+t.info.yeas+" votes)").attr("x",c+p/2).attr("y","48%").attr("text-anchor","end").attr("font-size","18px").attr("font-weight","300").attr("fill","black"),D=m.append("text").text(Math.round(parseFloat(t.info.nays/t.info.total_votes)*100)+"% ("+t.info.nays+" votes)").attr("x",c+p/2).attr("y","54%").attr("text-anchor","end").attr("font-size","18px").attr("font-weight","300").attr("fill","black"),P=m.append("text").text("$"+j(i)).attr("x","50%").attr("y","40%").attr("text-anchor","middle").attr("font-size","24px").attr("font-weight","700").attr("fill","black"),H=m.append("text").text("$"+j(s)).attr("x","50%").attr("y","62%").attr("text-anchor","middle").attr("font-size","24px").attr("font-weight","700").attr("fill","black")});