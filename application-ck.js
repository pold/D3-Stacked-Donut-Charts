function stash(e){e.x0=e.x;e.dx0=e.dx}function arcTween(e){var t=d3.interpolate({x:e.x0,dx:e.dx0},e);return function(n){var r=t(n);e.x0=r.x;e.dx0=r.dx;return arc(r)}}var width=960,height=700,radius=300,svg=d3.select("#graph").append("svg").attr("width",width).attr("height",height).append("g").attr("transform","translate("+width/2+","+height/2+")"),partition=d3.layout.partition().sort(null).size([2*Math.PI,radius*radius]).value(function(e){return e.size}),arc=d3.svg.arc().startAngle(function(e){return e.x}).endAngle(function(e){return e.x+e.dx}).innerRadius(function(e){return Math.sqrt(e.y)}).outerRadius(function(e){return Math.sqrt(e.y+e.dy)}),depth1_colors=d3.scale.ordinal().range(["#F89A28","#F89A28"]),depth2_colors=d3.scale.category20c(),politician_colors=d3.scale.ordinal().range(["rgb(92,188,239)","rgb(255,76,76)","rgb(150,163,170)"]).domain("D","I","R");d3.json("data.json",function(e,t){var n=svg.datum(t).selectAll("g").data(partition.nodes).enter().append("g");t.children[0].value>=t.children[1].value?n.attr("transform","rotate(-90)"):n.attr("transform","rotate(90)");var r=n.append("path").attr("d",arc).attr("id",function(e,t){return"path"+t}).attr("stroke","#FFF").attr("fill",function(e,t){return e.depth==0?"#000":e.depth==1?depth1_colors(t):e.depth==2?depth2_colors(e.name):politician_colors(e.party)}).attr("fill-rule","evenodd").attr("opacity",function(e){if(e.depth==0)return 0;if(e.depth>2)return 0}).on("click",function(e){if(e.depth>1)var t=e,n=d3.selectAll("path").filter(function(e){if(e.parent==t)return this}).transition().duration(250).attr("opacity",function(e){return d3.select(this)[0][0].attributes.opacity.value=="0"?1:0})}).each(stash),i=n.append("text").attr("font-size","0.85em").attr("fill","#FFF").attr("text-anchor","middle").attr("dy","2em").attr("transform",function(e){return"rotate("+e.dx*180/(2*Math.PI)+")"}).append("textPath").attr("xlink:href",function(e,t){return"#path"+t}).attr("opacity",function(e){if(e.depth==0)return 0;if(e.depth>2)return 0}).text(function(e){return e.name})});d3.select(self.frameElement).style("height",height+"px");